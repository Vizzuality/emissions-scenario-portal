<div class="row">
  <div class="small-4 columns">
    <div class="l-indicators__title f-ff3-m-bold">Indicators <span>(<%= @indicators.count %>)</span></div>
  </div>
  <div class="small-2 columns">
    <div class="c-form-item js-table-filter" data-filter-type="select" data-filter-key="type">
      <label class="f-ff1-m">Filter by type</label>
      <div class="c-select">
        <%= select_tag 'filters[type]',
                      types_for_select,
                      class: 'js-form-input js-select',
                      prompt: 'Select any type' %>
      </div>
    </div>
  </div>
  <div class="small-2 columns">
    <div class="c-form-item js-table-filter" data-filter-type="multiselect" data-filter-key="category">
      <label class="f-ff1-m">Filter by Category</label>
      <div class="c-select">
        <%= select_tag 'filters[category]',
                      categories_for_select,
                      class: 'js-form-input js-multiple-select',
                      'data-placeholder' => 'Select any category',
                      multiple: true %>
      </div>
    </div>
  </div>
  <div class="small-2 columns">
    <div class="c-form-item">
      <label class="f-ff1-m-bold"></label>
      <%= render 'shared/components/form/c_input_search.html',
                 placeholder: 'Search',
                 js_class: 'js-table-filter',
                 data: {
                   'filter-type' => 'search',
                   'filter-key' => 'search'
                 } %>
    </div>
  </div>
  <div class="small-2 columns">
    <%= link_to new_model_indicator_url(@model) do %>
      <div class="c-button l-indicators__add-new"><span>Add new indicator</span></div>
    <% end %>
  </div>
</div>
<div class="l-indicators__table-shorts js-table-filter" data-filter-type="order">
  <div class="row">
    <div class="small-3 columns">
      <%= render 'shared/components/c_order_filter_button',
                 text: 'Name',
                 other_class: '-no-wrap',
                 column_key: 'name' %>
    </div>
    <div class="small-2 columns">
      <%= render 'shared/components/c_order_filter_button',
                 text: 'Unit',
                 other_class: '-no-wrap',
                 column_key: 'unit' %>
    </div>
    <div class="small-3 columns">
      <%= render 'shared/components/c_order_filter_button',
                 text: 'Description',
                 other_class: '-no-wrap',
                 column_key: 'definition' %>
    </div>
    <div class="small-2 columns">
      <%= render 'shared/components/c_order_filter_button',
                 text: 'Type',
                 other_class: '-no-wrap',
                 column_key: 'type' %>
    </div>
  </div>
</div>
<% @indicators.each do |indicator| %>
  <div class="c-table-list-item">
    <div class="row">
      <div class="small-3 columns">
        <div class="c-table-list-item__text f-ff1-m-bold">
          <%= link_to indicator.alias, model_indicator_url(@model, indicator) %>
        </div>
      </div>
      <div class="small-2 columns">
        <div class="c-table-list-item__text f-ff1-m"><%= indicator.unit %></div>
      </div>
      <div class="small-3 columns">
        <div class="c-table-list-item__text f-ff1-m">
          <%= indicator.definition && truncate(indicator.definition, length: 120) %>
        </div>
      </div>
      <div class="small-2 columns">
        <div class="c-table-list-item__text f-ff1-m">
          <%= indicator.scope.to_s.humanize %>
          <% if indicator.variation? %>
            <div class="l-indicators__based-on">
              Based on: <%= link_to indicator.parent.alias, model_indicator_url(@model, indicator.parent) %>
            </div>
          <% end %>
        </div>
      </div>
      <div class="small-2 columns">
        <div class="c-table-list-item__actions">
          <% if current_user.can?(:destroy, indicator) %>
            <%= link_to model_indicator_url(@model, indicator), method: :delete, data: {confirm: destroy_confirmation_message(indicator)} do %>
              <div class="c-remove-button">
                <svg class="icon"><use xlink:href="#icon-delete"></use></svg>
                <div class="f-ff1-s">Delete</div>
              </div>
            <% end %>
          <% end %>
          <% if current_user.can?(:manage, indicator) %>
            <%= link_to edit_model_indicator_url(@model, indicator) do %>
              <div class="c-edit-button">
                <div class="c-edit-button__bubble">
                  <svg class="icon"><use xlink:href="#icon-edit"></use></svg>
                </div>
                <div class="f-ff1-s">Edit</div>
              </div>
            <% end %>
          <% else %>
            <%= link_to fork_model_indicator_url(@model, indicator) do %>
              <div class="c-edit-button">
                <div class="c-edit-button__bubble">
                  <svg class="icon"><use xlink:href="#icon-edit"></use></svg>
                </div>
                <div class="f-ff1-s">Fork</div>
              </div>
            <% end %>
          <% end %>
        </div>
      </div>
    </div>
  </div>
<% end %>
